---
layout: post
author: ndifix
title: "暗号に関する初めの初め"
date: 2021-03-13 0:0:0
categories: Cryptography
---

"暗号"ってなんかワクワクしませんか  
暗号を使って会話すると「自分たちにしかわからない話」ができてるみたいでドキドキするし、他人が使ってる暗号を破るのはパズルを解いてるみたいで楽しい。

自分で暗号を作って遊んでいればどんなものが "いい暗号" なのかが気になるところ。
<!--more-->

$$
暗号化したいメッセージを $m$として, 関数 $f$ で暗号化するならば  
暗号文は $f(m)$, 復号化関数は$f^{-1}$ ということになる。

$f(m)$ は第三者に見られるものだが、この $f(m)$ から $f^{-1}$ の情報を得ることができてしまえばそれは第三者に暗号が破られたことになる。完全な $m$ の情報を得ることができなくても一部の情報が得られただけでそれは悪い暗号ということになる。  
(パスワードの文字数と最初の数文字がバレるだけでちょっと怖くないですか　私は怖いです)

つまり "いい暗号" というのは
- $f(m)$ から $f^{-1}$ を推測するのが難しいこと
- $f(m)$ から $m$ のどんな部分的な情報も得ることが難しいこと

の両方を満たしている関数 $f$ をいうことにする。
$$

ここで暗号代表 RSA が "いい暗号" なことを確認してみる  
## RSA暗号の鍵生成

1. 相異なる素数 $p,q$ を任意に定めて $n=pq$ とする　ただし $n>m$ となるようにする
1. $\varphi = (p-1)(q-1)$ とする
1. 正整数 $e\in\mathbb{Z}_{\varphi}^{\times}$ を任意に定める
1. $d=e^{-1}$ とする
1. $f(m)=m^e\mod n, \;\; f^{-1}(M)=M^d\mod n$ とする

ここからちょっとだけ数学の話

## これが鍵になっていることの確認
一意に復号できることを確かめていく

中国剰余定理と
オイラーの定理:  
$m,n$を互いに素な正整数,  
$\varphi (n)=n$以下の正整数であって$n$と互いに素なものの個数　とすると  
$m^{\varphi(n)} = 1 \mod n$
を認める。

今回 $n=pq$ なので $\varphi(n)=(p-1)(q-1)$
$$
\begin{aligned}
m^{ed} 
&= m^{a\varphi+1}\;\;\;\; (a{\sf \small はある整数})\\
\end{aligned}
$$

1 ${\rm gcd}(m,n)=1$ の場合\\
$$
\begin{aligned}
&{\sf\small オイラーの定理をそのまま適用できて}\\
&m^{ed} 
= m^{a\varphi+1}
= m\\
\end{aligned}
$$

2 ${\rm gcd}(m,n)=p $ の場合 $\;\;$ ( ${\rm gcd}(m,n)=q$ の場合も同様)\\
$$
\begin{aligned}
m\left(m^{\varphi(n)}-1\right) &= 0 \;\mod p\\
m^{\varphi(n)+1} &= m \mod p\\
m^{(p-1)(q-1)+1} &= m \mod p\\
\end{aligned}
$$
一方で
$$
\begin{aligned}
m^{q-1} &= 1 \;\mod q\\
m^{(q-1)(p-1)+1} &= m \mod q\\
\end{aligned}
$$
したがって中国剰余定理から
$$
\begin{aligned}
m^{(q-1)(p-1)+1} &= m \mod n\\
m^{ed} = m^{a\varphi+1} &= m \mod n\\
\end{aligned}
$$


以上よりいずれの場合においても
$$
f^{-1}\circ f(m) = m^{ed} = m^{a\varphi+1} = m \mod n\\
$$
が得られている。$m< n$ なので$m$は完全に復号されている。
$$

一意に復号できるのでこれで鍵として機能することが分かった。

## RSAは"いい暗号" なのか
これについては次回。
